<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Contact_Line_Advection_Level_Set: Contact Line Advection using the Level Set Method</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sfb1194.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Contact_Line_Advection_Level_Set
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Solving the contact line advection problem with the level set method</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Contact Line Advection using the Level Set Method </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This software uses a Finite Volume based discretization of the level set equation to solve for the evolution of an interface being in contact with the domain boundary. The present implementation has been used to produce the results in the manuscript [1], which has been submitted to the Proceedings in Applied Mathematics and Mechanics (<a href="https://onlinelibrary.wiley.com/journal/16177061">https://onlinelibrary.wiley.com/journal/16177061</a>). An additional publication concerning the contact line advection with the Volume-of-Fluid method is in preparation [4].</p>
<p>Within the level set method (see, e.g. [5]), the interface is represented as the zero contour of some smooth function, i.e. the interface at time t is given as the set</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Sigma(t) = \{x \in \Omega: \phi(t,x) = 0 \}. \]" src="form_3.png"/>
</p>
<p>The interface is advected by a prescribed velocity field v according to the evolution equation</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t \phi + v \cdot \nabla \phi = 0. \]" src="form_4.png"/>
</p>
<p>This problem emerges from the discretization of continuum models for dynamic wetting, where the velocity field is a solution of the two-phase Navier Stokes equations. Here we are interested in the time evolution of both the <em>contact line</em>, i.e. the line of contact of the interface and the domain boundary, and the <em>contact angle</em> which is the angle of intersection between the interface and the boundary. In the Journal publications [2] and [3], we proved a fundamental kinematic relationship between the rate of change of the contact angle and the transporting velocity field. The kinematic evolution equation serves as a reference to validate the numerical solution of the level set equation in terms of the contact line position and the contact angle.</p>
<p>The method is capable of solving the transport equation in both two and three dimensions, while the automatic evaluation of the contact angle over time is currently only implemented for the two-dimensional case.</p>
<h3>Authors of the software</h3>
<ul>
<li>Mathis Fricke (<a href="#" onclick="location.href='mai'+'lto:'+'fri'+'ck'+'e@m'+'ma'+'.tu'+'-d'+'arm'+'st'+'adt'+'.d'+'e'; return false;">frick<span style="display: none;">.nosp@m.</span>e@mm<span style="display: none;">.nosp@m.</span>a.tu-<span style="display: none;">.nosp@m.</span>darm<span style="display: none;">.nosp@m.</span>stadt<span style="display: none;">.nosp@m.</span>.de</a>), Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
<li>Tomislav Marić (<a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ic'+'@mm'+'a.'+'tu-'+'da'+'rms'+'ta'+'dt.'+'de'; return false;">maric<span style="display: none;">.nosp@m.</span>@mma<span style="display: none;">.nosp@m.</span>.tu-d<span style="display: none;">.nosp@m.</span>arms<span style="display: none;">.nosp@m.</span>tadt.<span style="display: none;">.nosp@m.</span>de</a>), Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
<li>Aleksandar Vučković (<a href="#" onclick="location.href='mai'+'lto:'+'ale'+'ks'+'and'+'ar'+'.vu'+'ck'+'ovi'+'c@'+'stu'+'d.'+'tu-'+'da'+'rms'+'ta'+'dt.'+'de'; return false;">aleks<span style="display: none;">.nosp@m.</span>anda<span style="display: none;">.nosp@m.</span>r.vuc<span style="display: none;">.nosp@m.</span>kovi<span style="display: none;">.nosp@m.</span>c@stu<span style="display: none;">.nosp@m.</span>d.tu<span style="display: none;">.nosp@m.</span>-darm<span style="display: none;">.nosp@m.</span>stad<span style="display: none;">.nosp@m.</span>t.de</a>), Student at Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
</ul>
<h3>References</h3>
<ul>
<li>[1] M. Fricke, T. Marić and D. Bothe: Contact Line Advection using the Level Set Method, Proceedings in Applied Mathematics and Mechanics, submitted</li>
<li>[2] M. Fricke, M. Köhne and D. Bothe: A Kinematic Evolution Equation for the Dynamic Contact Angle and some Consequences. Physica D: Nonlinear Phenomena, 394:26–43, <a href="https://doi.org/10.1016/j.physd.2019.01.008">https://doi.org/10.1016/j.physd.2019.01.008</a> (2019)</li>
<li>[3] M. Fricke, M. Köhne and D. Bothe: On the Kinematics of Contact Line Motion, Proceedings in Applied Mathematics and Mechanics, <a href="https://doi.org/10.1002/pamm.201800451">https://doi.org/10.1002/pamm.201800451</a> (2018)</li>
<li>[4] M. Fricke, T. Marić and D. Bothe: Contact Line Advection using the Volume-of-Fluid Method, in preparation</li>
<li>[5] Y. Giga: Surface Evolution Equations: A Level set Approach, in: Monographs in Mathematics, vol. 99, Birkhäuser, Basel, <a href="http://dx.doi.org/10.1007/3-7643-7391-1">http://dx.doi.org/10.1007/3-7643-7391-1</a> (2006)</li>
</ul>
<p>Note that [2] is also available on the arXiv preprint server, see <a href="https://arxiv.org/abs/1810.00830">https://arxiv.org/abs/1810.00830</a>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Installation</h1>
<h3>Dependencies</h3>
<p>The software is most easily compiled on Unix system using the GNU compiler. It has also been tested successfully on Windows 10 using the Cygwin project (<a href="https://www.cygwin.com/">https://www.cygwin.com/</a>).</p>
<ul>
<li>g++ (GCC) 6.1</li>
<li>make</li>
<li>ParaView for Visualization</li>
</ul>
<p>In order to rebuild the documentation from the source code, one further needs the software <em>doxygen</em> which is available for all platforms (see www.doxygen.nl).</p>
<h3>Compiling the software</h3>
<p>On a Unix system enter the src/ directory and run make: </p><pre class="fragment">cd src/
make
</pre><h1><a class="anchor" id="autotoc_md2"></a>
Usage</h1>
<p>To run the program, execute </p><pre class="fragment">./finiteVolumes
</pre><p>Within the same directory, you will find the files contactAngle.csv and position.csv. The first column represents the simulation time, the second is the actual value and the third is the reference value. You will find a folder named data/ as well. It will contain the binary files of the field, its level set value, velocity field and the XMF file necessary to visualize everything in Paraview (version 5.5 and higher).</p>
<h2>Inputfile</h2>
<p>All parameters in the Inputfile need to be set in order for the program to work correctly. The order of the parameters is NOT interchangeable. The physical parameters have arbitrary units. They are as follows:</p>
<table class="doxtable">
<tr>
<th>Variable name </th><th>Description  </th></tr>
<tr>
<td>numX, numY, numZ</td><td>Number of cells in the given direction </td></tr>
<tr>
<td>lenX, lenY, lenZ</td><td>Length of simulation plane in the given direction </td></tr>
<tr>
<td>time </td><td>The simulation time </td></tr>
<tr>
<td>CFL </td><td>Courant-Friedrichs-Lewy-number </td></tr>
<tr>
<td>writestepsFraction </td><td>Fraction of total timesteps that will be written to disk </td></tr>
<tr>
<td>writeField</td><td>Whether to write the level set field binary files to disk. The files contactAngle.csv and position.csv are always written (see below) </td></tr>
<tr>
<td>v0, c1, c2, field </td><td>The field and its parameters. For the navier field all three parameters are relevant, but for the shear field, c1 and c2 are ignored and only the value of v0 matters. </td></tr>
<tr>
<td>centerX, centerY, centerZ </td><td>The initial center of the droplet. </td></tr>
<tr>
<td>expcpX, expcpY, expcpZ, expAngle </td><td>The expected coordinates for the initial contact point and the expected initial contact angle. Those are used for the reference solutions. </td></tr>
<tr>
<td>trackedContactPoint </td><td>Whether to track the left or right contact point. Only applicable in 2D. </td></tr>
</table>
<h3>Implementation</h3>
<p>The numerical method is based on an Explicit Euler Finite Volume Method on a regular cartesian grid (xxx). The program is structured into six files.</p>
<table class="doxtable">
<tr>
<th>File name </th><th>Description  </th></tr>
<tr>
<td><a class="el" href="main_8cpp.html">main.cpp</a> </td><td>Reads the inputfile and handles the top-level loop which evolves the field with time. </td></tr>
<tr>
<td>Field.cpp/hpp </td><td>The fundamental field class. Each instance of field represents an equidistant grid of any type parameter. </td></tr>
<tr>
<td>LevelSet.cpp/hpp </td><td>This class extends <a class="el" href="class_field.html" title="The template for the abstract field class. ">Field</a>, instantiated with "double" as its type parameter and obviously represents the levelset field. <br />
It is contains most of the important methods such as <a class="el" href="class_level_set.html#a5d3fb6f7df4bba4a47c4ba437bf9ee57">calculatedNextTimestep</a> and <a class="el" href="class_level_set.html#a5aacda3799b59321b249369cfcd8d50f">getContactAngle</a>. An object of class <a class="el" href="class_level_set.html" title="The class of the Level set field. ">LevelSet</a> is instantiated at the beginning within the <a class="el" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The main function of the program. ">main()</a> function. </td></tr>
<tr>
<td>VelocityField.cpp/hpp </td><td>An object of class <a class="el" href="class_velocity_field.html" title="The class of the velocity field acting on the Level set field. ">VelocityField</a> represents a chosen velocity field. It is aware of its parameters type (for example whether it is a shear field with v0 = 2) and the domain it is applicable on. </td></tr>
<tr>
<td>velocityFields.cpp/hpp </td><td>This is a library that contains the definitions of the velocity fields. </td></tr>
<tr>
<td>vecMath3D.cpp/hpp </td><td>This is a library of operator overloads and functions for vector analysis. </td></tr>
</table>
<h3>Adding a new velocity field</h3>
<p>To add a new velocity field, add it and its Jacobian matrix to the files velocityFields.cpp and .hpp. Next, add the appropriate if-statement to the <a class="el" href="class_velocity_field.html#a767fce45fffffeab12e72647618c213c" title="Evaluates the velocity field at the given point. ">VelocityField::at</a> member function. </p>
<h1><a class="anchor" id="autotoc_md3"></a>
Examples</h1>
<h2>Navier slip type field (src/testcases/navier)</h2>
<div class="image">
<img src="images/results_angle_navier.jpg" alt="Contact Angle Evolution for the Navier testcase."/>
</div>
<div class="image">
<img src="images/error_angle_navier.jpg" alt="Contact Angle Error for the Navier testcase."/>
</div>
<div class="image">
<img src="images/results_position_navier.jpg" alt="Contact Line Position for the Navier testcase."/>
</div>
<div class="image">
<img src="images/error_position_navier.jpg" alt="Position Error for the Navier testcase."/>
</div>
<h2>Vortex-in-a-box field (src/testcases/shear)</h2>
<div class="image">
<img src="images/results_angle_shear.jpg" alt="Contact Angle Evolution for the shear testcase."/>
</div>
<div class="image">
<img src="images/error_angle_shear.jpg" alt="Contact Angle Error for the shear testcase."/>
</div>
<div class="image">
<img src="images/results_position_shear.jpg" alt="Contact Line Position for the shear testcase."/>
</div>
<div class="image">
<img src="images/error_position_shear.jpg" alt="Position Error for the shear testcase."/>
</div>
<div class="image">
<img src="images/snapshotShear.png" alt="A snapshot of the simulation"/>
</div>
<h2>Time-dependent field (src/testcases/timeDependentNavier)</h2>
<div class="image">
<img src="images/results_angle_time_dependent_navier.jpg" alt="Contact Angle Evolution for the time dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/error_angle_time_dependent_navier.jpg" alt="Contact Angle Error for the time dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/results_position_time_dependent_navier.jpg" alt="Contact Line Position for the time dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/error_position_time_dependent_navier.jpg" alt="Position Error for the time dependent Navier testcase."/>
</div>
<center>
  <video src="images/animationNavier.ogv" controls></video>
  </center>
<h1><a class="anchor" id="autotoc_md4"></a>
Further information</h1>
<p>(xxx doxygen, contact to us, sfb info, licence?) </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
